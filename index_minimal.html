<!DOCTYPE html>
<html lang="mn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–≠—Ö–ª—ç–ª 1 ‚Äî ÌÅ¥Î¶≠ Ïãú ÎúªÎßå Î≥¥Ïù¥Í∏∞ (minimal)</title>
<style>
  body{margin:0;padding:16px 16px 140px;font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans,Apple SD Gothic Neo,Malgun Gothic,Helvetica Neue,Arial,sans-serif;line-height:1.8}
  #text{white-space:pre-wrap;font-size:18px}
  .word{cursor:pointer;padding:2px 4px;border-radius:6px}
  .word:active{background:#eef}
  #defsWrap{
    position:fixed;left:0;right:0;bottom:0;
    border-top:1px solid #e5e7eb;background:#fff;padding:12px 16px;
    box-shadow:0 -6px 18px rgba(0,0,0,.06);
  }
  #defs{font-size:16px}
  #defs .def{padding:2px 0}
</style>
</head>
<body>
<div id="text"></div>
<div id="defsWrap" hidden>
  <div id="defs"></div>
</div>

<script>
// --- Î≥∏Î¨∏ ---
const textData = `[1] –≠—Ö—ç–Ω–¥ –ë—É—Ä—Ö–∞–Ω —Ç—ç–Ω–≥—ç—Ä –±–∞ –≥–∞–∑—Ä—ã–≥ –±“Ø—Ç—ç—ç–∂—ç—ç. [2] –ì–∞–∑–∞—Ä –Ω—å —Ö—ç–ª–±—ç—Ä–∂—ç—ç–≥“Ø–π, —Ö–æ–æ—Å–æ–Ω —Ç”©–¥–∏–π–≥“Ø–π –æ—ë–æ—Ä–≥“Ø–π –≥“Ø–Ω–∏–π –≥–∞–¥–∞—Ä–≥—É—É–¥ —Ö–∞—Ä–∞–Ω—Ö—É–π –±“Ø—Ä—Ö—ç–∂, –ë—É—Ä—Ö–∞–Ω—ã –°“Ø–Ω—Å —É—Å–Ω—ã –º–∞–Ω–¥–∞–ª –¥—ç—ç–≥“Ø“Ø—Ä —ç–ª–∏–Ω —Ö–∞–ª—å–∂ –±–∞–π–ª–∞–∞. [3] –¢—ç–≥—ç—Ö—ç–¥ –ë—É—Ä—Ö–∞–Ω ‚Äî–ì—ç—Ä—ç–ª –±–∏–π –±–æ–ª—Ç—É–≥–∞–π! –≥—ç–∂ –∞–π–ª–¥—Å–∞–Ω–¥ –≥—ç—Ä—ç–ª –±–∏–π –±–æ–ª–æ–≤. [4] –ì—ç—Ä—ç–ª —Å–∞–π–Ω –±–æ–ª—Å–Ω—ã–≥ –ë—É—Ä—Ö–∞–Ω —Ö–∞—Ä–∂, –ë—É—Ä—Ö–∞–Ω –≥—ç—Ä–ª–∏–π–≥ —Ö–∞—Ä–∞–Ω—Ö—É–π–≥–∞–∞—Å —Å–∞–ª–≥–∞–∂—ç—ç. [5] –ë—É—Ä—Ö–∞–Ω –≥—ç—Ä–ª–∏–π–≥ ”©–¥”©—Ä –≥—ç–∂ –Ω—ç—Ä–ª—ç—ç–¥, —Ö–∞—Ä–∞–Ω—Ö—É–π–≥ —à”©–Ω”© –≥—ç–∂ –Ω—ç—Ä–ª—ç–ª—ç—ç. –ò–π–Ω “Ø–¥—ç—à –±–æ–ª–æ–æ–¥, ”©–≥–ª”©”© –±–æ–ª—Å–æ–Ω –Ω—å –∞–Ω—Ö–Ω—ã ”©–¥”©—Ä. [6] –ë—É—Ä—Ö–∞–Ω ‚Äî–£—Å–Ω—ã –¥—É–Ω–¥—É—É—Ä –æ–≥—Ç–æ—Ä–≥—É–π –±–∞–π–∂, –∏–π–Ω—Ö“Ø“Ø —É—Å—ã–≥ —É—Å–Ω–∞–∞—Å —Å–∞–ª–≥–∞—Ç—É–≥–∞–π! –≥—ç–∂ –∞–π–ª–¥–∞–≤. [7] –ë—É—Ä—Ö–∞–Ω –∏–Ω–≥—ç–∂ –æ–≥—Ç–æ—Ä–≥—É–π–≥ –±–∏–π –±–æ–ª–≥–æ–æ–¥, –æ–≥—Ç–æ—Ä–≥—É–π–Ω –¥—ç—ç—Ä—Ö —É—Å–Ω–∞–∞—Å –æ–≥—Ç–æ—Ä–≥—É–π–Ω –¥–æ–æ—Ä—Ö —É—Å—ã–≥ —Å–∞–ª–≥–∞—Å–∞–Ω–¥ —ë—Å–æ–æ—Ä –±–æ–ª–æ–≤. [8] –ë—É—Ä—Ö–∞–Ω –æ–≥—Ç–æ—Ä–≥—É–π–≥ —Ç—ç–Ω–≥—ç—Ä –≥—ç–∂ –Ω—ç—Ä–ª—ç–∂—ç—ç. “Æ–¥—ç—à –±–æ–ª–æ–æ–¥, ”©–≥–ª”©”© –±–æ–ª—Å–æ–Ω –Ω—å —Ö–æ—ë—Ä –¥–∞—Ö—å ”©–¥”©—Ä. [9] –ë—É—Ä—Ö–∞–Ω ‚Äî–¢—ç–Ω–≥—ç—Ä–∏–π–Ω –¥–æ–æ—Ä—Ö —É—Å –Ω—ç–≥ –¥–æ—Ä —Ö—É—Ä–∏–º—Ç–ª–∞–≥–¥–∞–∂, –∏–π–Ω —Ö—É—É—Ä–∞–π –≥–∞–∑–∞—Ä –∏–ª –≥–∞—Ä—Ç—É–≥–∞–π! –≥—ç—Å—ç–Ω–¥ —ë—Å–æ–æ—Ä –±–æ–ª–∂—ç—ç. [10] –ë—É—Ä—Ö–∞–Ω —Ö—É—É—Ä–∞–π–≥ –Ω—å –≥–∞–∑–∞—Ä, —Ö—É—Ä–∏–º—Ç–ª–∞–≥–¥—Å–∞–Ω —É—Å—ã–≥ –Ω—å –¥–∞–ª–∞–π –≥—ç–∂ –Ω—ç—Ä–ª—ç–≤. –≠–¥–≥—ç—ç—Ä –Ω—å —Å–∞–π–Ω –±–æ–ª—Å–Ω—ã–≥ –ë—É—Ä—Ö–∞–Ω —Ö–∞—Ä–ª–∞–∞. [11] –ò–Ω–≥—ç—ç–¥ –ë—É—Ä—Ö–∞–Ω ‚Äî–ì–∞–∑–∞—Ä –Ω—å —É—Ä–≥–∞–º–∞–ª –Ω–æ–≥–æ–æ–≥ –±—É—é—É “Ø—Ä–ª—ç–≥—á ”©–≤—Å –Ω–æ–≥–æ–æ, –¥–æ—Ç–æ—Ä—Ö “Ø—Ä—ç—ç –≥–∞–∑–∞—Ä—Ç –≥”©–≤–¥”©–≥ “Ø—Ä –∂–∏–º—Å—Ç –º–æ–¥—ã–≥ —Ç”©—Ä”©–ª —Ç”©—Ä–ª”©”©—Ä –Ω—å —É—Ä–≥—É—É–ª—Ç—É–≥–∞–π! –≥—ç–∂ –∞–π–ª–¥—Å–∞–Ω–¥ —ë—Å–æ–æ—Ä –±–æ–ª–∂—ç—ç. [12] –ì–∞–∑–∞—Ä –Ω—å –∏–π–Ω—Ö“Ø“Ø —É—Ä–≥–∞–º–∞–ª –Ω–æ–≥–æ–æ–≥ –±—É—é—É “Ø—Ä–ª—ç–≥—á ”©–≤—Å –Ω–æ–≥–æ–æ, –¥–æ—Ç–æ—Ä—Ö “Ø—Ä—ç—ç –≥–∞–∑–∞—Ä—Ç –≥”©–≤–¥”©–≥ “Ø—Ä –∂–∏–º—Å—Ç –º–æ–¥—ã–≥ —Ç”©—Ä”©–ª —Ç”©—Ä–ª”©”©—Ä –Ω—å –≥–∞—Ä–≥–∞–≤. –≠–¥–≥—ç—ç—Ä –Ω—å —Å–∞–π–Ω –±–æ–ª—Å–Ω—ã–≥ –ë—É—Ä—Ö–∞–Ω —Ö–∞—Ä–ª–∞–∞. [13] “Æ–¥—ç—à –±–æ–ª–æ–æ–¥, ”©–≥–ª”©”© –±–æ–ª—Å–æ–Ω –Ω—å –≥—É—Ä–∞–≤ –¥–∞—Ö—å ”©–¥”©—Ä. [14] –¢—ç–≥—ç—ç–¥ –ë—É—Ä—Ö–∞–Ω ‚Äî”®–¥—Ä–∏–π–≥ —à”©–Ω”©”©—Å —Å–∞–ª–≥–∞—Ö—ã–Ω —Ç—É–ª–¥ —Ç—ç–Ω–≥—ç—Ä –æ–≥—Ç–æ—Ä–≥—É–π–¥ –≥—ç—Ä—ç–ª—Ç“Ø“Ø–ª—ç–≥—á–∏–¥ –±–∞–π—Ö –±–æ–ª—Ç—É–≥–∞–π! –≠–¥–≥—ç—ç—Ä –Ω—å —Ç—ç–º–¥—ç–≥, —É–ª–∏—Ä–∞–ª, ”©–¥”©—Ä, –∂–∏–ª–∏–π–Ω —Ç—É–ª–¥ –±–∞–π–≥. [15] –¢—ç–Ω–≥—ç—Ä –æ–≥—Ç–æ—Ä–≥—É–π–¥ –≥—ç—Ä—ç–ª—Ç“Ø“Ø–ª—ç–≥—á–∏–¥ –±–∞–π–∂ –≥–∞–∑–∞—Ä –¥—ç–ª—Ö–∏–π–≥ –≥–∏–π–≥“Ø“Ø–ª—ç–≥! –≥—ç–∂ –∞–π–ª–¥—Å–∞–Ω–¥ —ë—Å–æ–æ—Ä –±–æ–ª–∂—ç—ç. [16] –ë—É—Ä—Ö–∞–Ω ”©–¥—Ä–∏–π–≥ –∑–∞—Ö–∏—Ä—É—É–ª–∞—Ö–∞–∞—Ä –Ω—ç–≥ —Ç–æ–º—Ö–æ–Ω –≥—ç—Ä—ç–ª—Ç“Ø“Ø–ª—ç–≥—á, —à”©–Ω–∏–π–≥ –∑–∞—Ö–∏—Ä—É—É–ª–∞—Ö–∞–∞—Ä –∞—Ä–∞–π –±–∞–≥–∞–≤—Ç–∞—Ä –≥—ç—Ä—ç–ª—Ç“Ø“Ø–ª—ç–≥—á, –∏–π–º —Ö–æ—ë—Ä —Ç–æ–º –≥—ç—Ä—ç–ª—Ç“Ø“Ø–ª—ç–≥—á–∏–π–≥ –º”©–Ω –æ–¥–¥—ã–≥ –±–∏–π –±–æ–ª–≥–æ–≤. [17] –ë—É—Ä—Ö–∞–Ω —Ç—ç–¥–≥—ç—ç—Ä—ç—ç—Ä –≥–∞–∑–∞—Ä –¥—ç–ª—Ö–∏–π–≥ –≥—ç—Ä—ç–ª—Ç“Ø“Ø–ª—ç—Ö—ç—ç—Ä —Ç—ç–Ω–≥—ç—Ä –æ–≥—Ç–æ—Ä–≥—É–π–¥ —Ç–∞–≤—å—Å–∞–Ω –Ω—å [18] ”©–¥”©—Ä, —à”©–Ω”© —Ö–æ—ë—Ä—ã–≥ –∑–∞—Ö–∏—Ä—É—É–ª–∞—Ö –±–∞—Å –≥—ç—Ä–ª–∏–π–≥ —Ö–∞—Ä–∞–Ω—Ö—É–π–≥–∞–∞—Å —Å–∞–ª–≥–∞—Ö—ã–Ω —Ç—É–ª–¥ –∞–∂–≥—É—É. –≠–¥–≥—ç—ç—Ä –Ω—å —Å–∞–π–Ω –±–æ–ª—Å–Ω—ã–≥ –ë—É—Ä—Ö–∞–Ω —Ö–∞—Ä–ª–∞–∞. [19] “Æ–¥—ç—à –±–æ–ª–æ–æ–¥, ”©–≥–ª”©”© –±–æ–ª—Å–æ–Ω –Ω—å –¥”©—Ä”©–≤ –¥—ç—Ö ”©–¥”©—Ä. [20] –ë—É—Ä—Ö–∞–Ω ‚Äî–®—É–Ω–≥–∞–Ω —à—É–º–±–∞–≥—á –∞–º—å–¥ –±–∏–µ—Ç—ç—ç—Ä —É—Å–Ω—É—É–¥ —Ü–∞–ª–≥–∏–ª—Ç—É–≥–∞–π, –±–∞—Å —à—É–≤—É—É–¥ –≥–∞–∑–∞—Ä –¥—ç–ª—Ö–∏–π –¥—ç—ç–≥“Ø“Ø—Ä, —Ç—ç–Ω–≥—ç—Ä –æ–≥—Ç–æ—Ä–≥—É–π–Ω –º–∞–Ω–¥–∞–ª–¥ –Ω–∏—Å—Ç“Ø–≥—ç–π! –≥—ç–∂ –∞–π–ª–¥–∞–≤. [21] –ò–π–Ω—Ö“Ø“Ø –ë—É—Ä—Ö–∞–Ω –¥–∞–ª–∞–π —Ç—ç–Ω–≥–∏—Å–∏–π–Ω –∞–≤–∞—Ä–≥–∞ —Ç–æ–º –∞–º—å—Ç–∞–¥ –±–∞ —É—Å–Ω–∞–∞ —à—É–Ω–≥–∞–Ω —à—É–º–±–∞–≥—á –∞–º—å–¥ –±–∏–µ—Ç–∏–π–≥ —Ç”©—Ä”©–ª —Ç”©—Ä–ª”©”©—Ä –Ω—å –±–∞—Å –∞–ª–∏–≤–∞–∞ –∂–∏–≥“Ø“Ø—Ä—Ç—ç–Ω —à—É–≤—É—É–¥—ã–≥ —Ç”©—Ä”©–ª —Ç”©—Ä–ª”©”©—Ä –Ω—å –±“Ø—Ç—ç—ç–≤. –≠–¥–≥—ç—ç—Ä –Ω—å —Å–∞–π–Ω –±–æ–ª—Å–Ω—ã–≥ –ë—É—Ä—Ö–∞–Ω —Ö–∞—Ä–ª–∞–∞. [22] –ë—É—Ä—Ö–∞–Ω —Ç—ç–¥–Ω–∏–π–≥ –µ—Ä”©”©–Ω ‚Äî“Æ—Ä–∂–∏–∂, –æ–ª—à–∏—Ä—Ü–≥–æ–æ–≥! –î–∞–ª–∞–π —Ç—ç–Ω–≥–∏—Å–∏–π–Ω —É—Å–∞–Ω–¥ –¥“Ø“Ø—Ä—Ü–≥—ç—ç–≥! –®—É–≤—É—É–¥ —á –≥–∞–∑–∞—Ä –¥—ç–ª—Ö–∏–π–¥ –æ–ª—à–∏—Ä—Ü–≥–æ–æ–≥! —Ö—ç–º—ç—ç–≤. [23] “Æ–¥—ç—à –±–æ–ª–æ–æ–¥, ”©–≥–ª”©”© –±–æ–ª—Å–æ–Ω –Ω—å —Ç–∞–≤ –¥–∞—Ö—å ”©–¥”©—Ä. [24] –ë—É—Ä—Ö–∞–Ω ‚Äî–ì–∞–∑–∞—Ä –¥—ç–ª—Ö–∏–π –∞–º—å–¥ –±–∏–µ—Ç–∏–π–≥ —Ç”©—Ä”©–ª —Ç”©—Ä–ª”©”©—Ä –Ω—å –±—É—é—É –º–∞–ª –∞–¥–≥—É—É—Å, –º”©–ª—Ö”©–≥—á–∏–¥, –≥–∞–∑—Ä—ã–Ω –∑—ç—Ä–ª—ç–≥ –∞–º—å—Ç–¥—ã–≥ —Ç”©—Ä”©–ª —Ç”©—Ä–ª”©”©—Ä –Ω—å –≥–∞—Ä–≥–∞—Ç—É–≥–∞–π! –≥—ç–∂ –∞–π–ª–¥—Å–∞–Ω–¥ —ë—Å–æ–æ—Ä –±–æ–ª–∂—ç—ç. [25] –ë—É—Ä—Ö–∞–Ω –∏–π–Ω—Ö“Ø“Ø –≥–∞–∑—Ä—ã–Ω –∑—ç—Ä–ª—ç–≥ –∞–º—å—Ç–¥—ã–≥ —Ç”©—Ä”©–ª —Ç”©—Ä–ª”©”©—Ä –Ω—å, –º–∞–ª –∞–¥–≥—É—É—Å—ã–≥ —Ç”©—Ä”©–ª —Ç”©—Ä–ª”©”©—Ä –Ω—å, –≥–∞–∑—Ä–∞–∞—Ä –º”©–ª—Ö”©–≥—á –±“Ø–≥–¥–∏–π–≥ —Ç”©—Ä”©–ª —Ç”©—Ä–ª”©”©—Ä –Ω—å –±–∏–π –±–æ–ª–≥–æ–≤. –≠–¥–≥—ç—ç—Ä –Ω—å —Å–∞–π–Ω –±–æ–ª—Å–Ω—ã–≥ –ë—É—Ä—Ö–∞–Ω —Ö–∞—Ä–ª–∞–∞. [26] –¢—ç–≥—ç—ç–¥ –ë—É—Ä—Ö–∞–Ω ‚Äî–ë–∏–¥ –¥“Ø—Ä —Ç”©—Ä—Ö–∏–π–Ω—Ö”©”© –¥–∞–≥—É—É –±–∏–¥—ç–Ω—Ç—ç–π –∞–¥–∏–ª—Ö–∞–Ω —Ö“Ø–Ω–∏–π–≥ –±—É–π –±–æ–ª–≥–æ—ë. –¢—ç–≥—ç—ç–¥ —Ç—ç–¥–Ω—ç—ç—Ä –¥–∞–ª–∞–π–Ω –∑–∞–≥–∞—Å, –æ–≥—Ç–æ—Ä–≥—É–π–Ω —à—É–≤—É—É–¥, –º–∞–ª –∞–¥–≥—É—É—Å, –±“Ø—Ö –≥–∞–∑–∞—Ä –¥—ç–ª—Ö–∏–π, –≥–∞–∑—Ä–∞–∞—Ä –º”©–ª—Ö–¥”©–≥ –º”©–ª—Ö”©–≥—á –±“Ø–≥–¥–∏–π–≥ –∑–∞—Ö–∏—Ä—É—É–ª—ä—è –≥—ç–∂ –∞–π–ª–¥–∞–≤. [27] –ò–π–Ω—Ö“Ø“Ø –ë—É—Ä—Ö–∞–Ω ”®”©—Ä–∏–π–Ω—Ö”©”© –¥“Ø—Ä —Ç”©—Ä—Ö”©”©—Ä —Ö“Ø–Ω–∏–π–≥ –±“Ø—Ç—ç—ç–∂, –ë—É—Ä—Ö–∞–Ω—ã –¥“Ø—Ä —Ç”©—Ä—Ö”©”©—Ä –±“Ø—Ç—ç—ç—Ö–¥—ç—ç —ç—Ä —ç–º—ç—ç—Ä –Ω—å –±“Ø—Ç—ç—ç–∂—ç—ç. [28] –ë—É—Ä—Ö–∞–Ω —Ç—ç–¥–Ω–∏–π–≥ –µ—Ä”©”©–∂ ‚Äî“Æ—Ä–∂–∏–∂, –æ–ª—à–∏—Ä—Ü–≥–æ–æ–≥! –ì–∞–∑–∞—Ä –¥—ç–ª—Ö–∏–π–≥ –¥“Ø“Ø—Ä–≥—ç–∂, —Ç“Ø“Ø–Ω–∏–π–≥ —ç–∑—ç–º—à–∏—Ü–≥—ç—ç–≥! –î–∞–ª–∞–π–Ω –∑–∞–≥–∞—Å, –æ–≥—Ç–æ—Ä–≥—É–π–Ω —à—É–≤—É—É–¥ —Ö–∏–π–≥—ç—ç–¥ –≥–∞–∑–∞—Ä –¥—ç—ç—Ä —Ö”©–ª—Ö”©–≥—á –∞–º—å—Ç–∞–Ω –±“Ø—Ö–Ω–∏–π–≥ –∑–∞—Ö–∏—Ä—Ü–≥–∞–∞–≥! –≥—ç–≤. [29] –ë—É—Ä—Ö–∞–Ω ‚Äî“Æ–∑—ç–≥—Ç“Ø–Ω, –≥–∞–∑—Ä—ã–Ω –≥–∞–¥–∞—Ä–≥–∞ –¥—ç—ç—Ä—Ö “Ø—Ä—Ç ”©–≤—Å –Ω–æ–≥–æ–æ –±“Ø—Ä–∏–π–≥, “Ø—Ä—ç—ç –≥”©–≤–¥”©–≥ “Ø—Ä –∂–∏–º—Å—Ç –º–æ–¥ –±“Ø–≥–¥–∏–π–≥ –ë–∏ —Ç–∞ –Ω–∞—Ä—Ç ”©–≥–Ω”©. –¢—ç—Ä –±“Ø—Ö—ç–Ω —Ç–∞ –Ω–∞—Ä—ã–Ω —Ö–æ–æ–ª —Ö“Ø–Ω—Å –±–æ–ª–Ω–æ. [30] –ì–∞–∑–∞—Ä –¥—ç–ª—Ö–∏–π–Ω –∑—ç—Ä–ª—ç–≥ –∞–º—å—Ç–∞–Ω –±“Ø—Ö—ç–Ω–¥, –æ–≥—Ç–æ—Ä–≥—É–π–Ω —à—É–≤—É—É –±“Ø—Ö—ç–Ω–¥, –≥–∞–∑—Ä–∞–∞—Ä –º”©–ª—Ö”©–≥—á –±“Ø—Ö—ç–Ω–¥, –∞–º—å—Ç–∞–π –∞–º—å—Å–≥–∞–ª—Ç–∞–π –±“Ø—Ö—ç–Ω–¥ ”©–≤—Å –Ω–æ–≥–æ–æ –±“Ø–≥–¥–∏–π–≥ —Ö–æ–æ–ª —Ö“Ø–Ω—Å –±–æ–ª–≥–æ–∂ ”©–≥—å–µ –≥—ç—Å—ç–Ω–¥ —ë—Å–æ–æ—Ä –±–æ–ª–∂—ç—ç. [31] ”®”©—Ä–∏–π–Ω—Ö –Ω—å –±—É–π –±–æ–ª–≥–æ—Å–æ–Ω –±“Ø–≥–¥ –Ω—ç–Ω —Å–∞–π–Ω –±–æ–ª—Å–Ω—ã–≥ –ë—É—Ä—Ö–∞–Ω —Ö–∞—Ä–ª–∞–∞. “Æ–¥—ç—à –±–æ–ª–æ–æ–¥, ”©–≥–ª”©”© –±–æ–ª—Å–æ–Ω –Ω—å –∑—É—Ä–≥–∞–∞ –¥–∞—Ö—å ”©–¥”©—Ä.`;

// --- ÌÜ†ÌÅ∞Ìôî ---
const CYRILLIC = /[\\u0400-\\u04FF]/;
const WORD_RE = /([\\u0400-\\u04FF]+)|(\\s+|[^\\u0400-\\u04FF]+)/g;
const SUFFIXES = ["–∞–∞—Å","—ç—ç—Å","–æ–æ—Å","”©”©—Å","—Ä—É—É","—Ä“Ø“Ø","–ª—É—É","–ª“Ø“Ø","–∞–∞—Ä","—ç—ç—Ä","–æ–æ—Ä","”©”©—Ä","—Ç–∞–π","—Ç—ç–π","—Ç–æ–π","—É—É–¥","“Ø“Ø–¥","–Ω—É—É–¥","–Ω“Ø“Ø–¥","—ã–Ω","–∏–π–Ω","–Ω—ã","–Ω–∏–π","—ã–≥","–∏–π–≥","–≥","–¥"].sort((a,b)=>b.length-a.length);

// --- Ï∫êÏãú ÏÑ§Ï†ï(Ï°∞Ïö©Ìûà 24ÏãúÍ∞Ñ; ÌïÑÏöî ÏóÜÏúºÎ©¥ InfinityÎ°ú Î∞îÍøîÎèÑ Îê®) ---
const CACHE_HOURS = 24;
function cacheKey(w){ return "mnmin:"+w.toLowerCase(); }

// --- Î†åÎçî ---
const textEl = document.getElementById("text");
const defsWrap = document.getElementById("defsWrap");
const defsEl = document.getElementById("defs");

function renderText(){
  const frag = document.createDocumentFragment();
  for (const m of textData.matchAll(WORD_RE)){
    const w = m[1], other = m[2];
    if (w){
      const s = document.createElement("span");
      s.textContent = w; s.className="word"; s.onclick = ()=>onWordClick(s);
      frag.appendChild(s);
    }else frag.appendChild(document.createTextNode(other));
  }
  textEl.innerHTML=""; textEl.appendChild(frag);
}
renderText();

function normalize(s){
  return s.replace(/^[‚Äî‚Äì\\-.,!?;:()\\[\\]¬´¬ª\"'‚Äú‚Äù‚Äò‚Äô]+|[‚Äî‚Äì\\-.,!?;:()\\[\\]¬´¬ª\"'‚Äú‚Äù‚Äò‚Äô]+$/g,"").trim();
}
function candidates(word){
  const base = word.toLowerCase();
  const c = new Set([word, base]);
  for (const suf of SUFFIXES){
    if (base.length > suf.length+1 && base.endsWith(suf)) c.add(base.slice(0, base.length - suf.length));
  }
  return Array.from(c);
}

async function onWordClick(el){
  const raw = normalize(el.textContent||"");
  if (!raw || !CYRILLIC.test(raw)) return;

  const key = cacheKey(raw);
  const cached = JSON.parse(localStorage.getItem(key) || "null");
  if (cached && Date.now() - cached.t < CACHE_HOURS*3600*1000){
    return showDefs(cached.senses);
  }

  let senses = [];
  // ÌõÑÎ≥¥ ÌòïÌÉúÎì§ ÏãúÎèÑ
  for (const cand of candidates(raw)){
    senses = await lookupSenses(cand);
    if (senses.length) break;
  }
  // ÎßàÏßÄÎßâÏúºÎ°ú Í≤ÄÏÉâ API
  if (!senses.length){
    const guess = await wiktSearch(raw);
    if (guess) senses = await lookupSenses(guess);
  }

  localStorage.setItem(key, JSON.stringify({ t: Date.now(), senses }));
  showDefs(senses);
}

async function lookupSenses(word){
  // MN ‚Üí EN#Mongolian ÏàúÏÑú
  let senses = await fetchWiktList(`https://mn.wiktionary.org/w/api.php?action=parse&prop=text&page=${encodeURIComponent(word)}&format=json&origin=*`, false);
  if (!senses.length){
    senses = await fetchWiktList(`https://en.wiktionary.org/w/api.php?action=parse&prop=text&page=${encodeURIComponent(word)}&format=json&origin=*`, true);
  }
  return senses;
}

async function wiktSearch(q){
  try{
    const url = `https://mn.wiktionary.org/w/api.php?action=opensearch&search=${encodeURIComponent(q)}&limit=1&namespace=0&format=json&origin=*`;
    const r = await fetch(url, { cache: 'no-store' });
    const j = await r.json();
    return j?.[1]?.[0] || null;
  }catch{ return null; }
}

async function fetchWiktList(apiUrl, needMongolian){
  try{
    const r = await fetch(apiUrl, { cache: 'no-store' });
    const j = await r.json();
    const html = j?.parse?.text?.["*"] || "";
    if (!html) return [];
    let section = html;
    if (needMongolian){
      const parts = html.split(/<span[^>]*id="Mongolian"[^>]*>/i);
      section = parts[1] || html;
    }
    const list = [...section.matchAll(/<li>(.*?)<\\/li>/g)]
      .map(m=>m[1].replace(/<[^>]+>/g,'').replace(/\\s+/g,' ').trim())
      .filter(Boolean)
      .slice(0, 10);
    return list;
  }catch{return [];}
}

function showDefs(list){
  defsWrap.hidden = false;
  defsEl.innerHTML = list.length
    ? list.map(s=>`<div class="def">‚Ä¢ ${escapeHtml(s)}</div>`).join("")
    : "ÎúªÏùÑ Î™ª Ï∞æÏïòÏñ¥ üò¢";
}
function escapeHtml(s){ return s.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;"); }
</script>
</body>
</html>
